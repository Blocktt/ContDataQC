---
title: "Report, Period Statistics"
subtitle: "ContDataQC"
author: "`r Sys.getenv('USERNAME')`"
date: "`r format(Sys.time(), '%Y-%m-%d %H:%M:%S')`"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float: no
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(results='asis', echo=FALSE, warning=FALSE)
# needed for trouble shooting
#myConfig <- file.path(system.file(package="ContDataQC"), "extdata", "config.ORIG.R")
#source(myConfig)
```

# DATA FILE INFORMATION
```{r data_file_info}
# Report Info
myReportDate <- format(Sys.Date(),fun.myDate.Format)
# myReportDate <- format(Sys.Date(),fd01)
cat(paste("**Report Date: ** ",myReportDate,"\n\n",sep=""))
myUser <- Sys.getenv("USERNAME")
cat(paste("**Generated By:** ",myUser,"\n\n",sep=""))
  
cat("**Benchmark Date: ** ",fun.myDate,collapse="\n\n",sep="")

cat("**Period (N, Units): ** ",paste(fun.myPeriod.N[1:numPeriods],fun.myPeriod.Units[1:numPeriods], collapse=", "),collapse="\n\n",sep="")

cat(paste("**Period Start Date: **",paste(as.Date(myDate.Start[1:numPeriods]),collapse=", "),sep=""),collapse="\n\n")

cat("**Minimum Date in File: **", myDate.File.Min, collapse="\n\n", sep="")

cat("**Difference (Benchmark-Minimum Date): **", myDate.Diff.FileMin.Benchmark, collapse="\n\n", sep="")

cat("**Parameter: ** ",fun.myParam.Name,collapse="\n\n",sep="")

cat("**Threshold: ** ",fun.myThreshold,collapse="\n\n",sep="")

cat("**QC Flag Failures Exclude: ** ",ContData.env$myStats.Fails.Exclude,collapse="\n\n",sep="")

cat("**Filename, Input: ** ",fun.myFile,"\n\n",sep="")
  
#cat("**Filename, Output: ** ",paste0(myFile.Export.part,myFile.Export.ext),sep="")
```

# Plot
Mean daily values for requested date ranges with line for threshold (if provided).
```{r stats_summary}
  for (k in 1:numPeriods){##FOR.j.START
      # subset
      df.plot <- df.summary[df.summary[,myDate.Name]>=as.Date(myDate.Start[k]) & df.summary[,myDate.Name]<=as.Date(myDate.End),]
      # create file name
      plot(df.plot[,1:2],main=paste0(fun.myDate," \n(",fun.myPeriod.N[k],fun.myPeriod.Units[k],")"))
      if(!is.na(fun.myThreshold)){
        abline(h=fun.myThreshold)
      }
    }##FOR.j.END
```
